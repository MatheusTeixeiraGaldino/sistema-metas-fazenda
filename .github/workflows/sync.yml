name: SincronizaÃ§Ã£o DiÃ¡ria de Colaboradores

on:
  # Roda todo dia Ã s 06h no horÃ¡rio de BrasÃ­lia (09:00 UTC)
  schedule:
    - cron: '0 9 * * *'

  # Permite rodar manualmente pelo GitHub (botÃ£o Run workflow)
  workflow_dispatch:
    inputs:
      modo:
        description: 'Modo de execuÃ§Ã£o'
        required: true
        default: 'normal'
        type: choice
        options:
          - normal
          - teste-apenas

jobs:
  sincronizar:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Baixar repositÃ³rio
        uses: actions/checkout@v4

      - name: ðŸŸ¢ Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ðŸ“¦ Instalar dependÃªncias
        run: npm install

      - name: ðŸ”„ Executar sincronizaÃ§Ã£o
        env:
          # Firebase
          FIREBASE_API_KEY: ${{ secrets.FIREBASE_API_KEY }}
          FIREBASE_AUTH_DOMAIN: ${{ secrets.FIREBASE_AUTH_DOMAIN }}
          FIREBASE_PROJECT_ID: ${{ secrets.FIREBASE_PROJECT_ID }}
          FIREBASE_STORAGE_BUCKET: ${{ secrets.FIREBASE_STORAGE_BUCKET }}
          FIREBASE_MESSAGING_SENDER_ID: ${{ secrets.FIREBASE_MESSAGING_SENDER_ID }}
          FIREBASE_APP_ID: ${{ secrets.FIREBASE_APP_ID }}
          FIREBASE_ADMIN_EMAIL: ${{ secrets.FIREBASE_ADMIN_EMAIL }}
          FIREBASE_ADMIN_SENHA: ${{ secrets.FIREBASE_ADMIN_SENHA }}
          # API do RH
          RH_API_URL: ${{ secrets.RH_API_URL }}
          RH_API_TOKEN: ${{ secrets.RH_API_TOKEN }}
          RH_API_USUARIO: ${{ secrets.RH_API_USUARIO }}
          RH_API_SENHA: ${{ secrets.RH_API_SENHA }}
          # Modo
          MODO_EXECUCAO: ${{ github.event.inputs.modo || 'normal' }}
        run: node sync.js

      - name: âœ… ConcluÃ­do
        run: echo "SincronizaÃ§Ã£o finalizada com sucesso!"
